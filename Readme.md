# 🖼️ Image Semantic Search Engine

**Cairo University | Computer Engineering Department | Spring 2024**  
Course: CMP4011 - Advanced Database

## 📖 Project Overview

This project focuses on building a **semantic search engine** for images using vectorized databases. The system stores image vectors generated by an AI model, allowing users to search for similar images by uploading a query image. The system uses **cosine similarity** to find and retrieve the top `k` most similar images from a large dataset.

## 🔍 What is Semantic Search?

**Semantic Search** goes beyond traditional keyword searches by understanding the context and meaning of the query. For this project, we use semantic search to compare and retrieve similar images based on their vectorized representations.

Instead of matching keywords or filenames, the system converts each image into a **vector embedding** that captures its content. When a user submits a query image, the system computes its vector representation and retrieves the most similar vectors from the database.

## 🛠️ Tools & Technologies

- **Programming Language**: Python
- **Libraries**: `numpy`, `scipy`, `pandas`, `matplotlib`, `sklearn`
- **No Database Management Systems**: Custom vectorized database system implemented in Python.
- **Similarity Metric**: Cosine Similarity
- **Vectorized Database**: Handles large image datasets with up to 20 million entries.

## 🔧 System Architecture

1. **Image Vectorization**:

   - Each image is converted into a **vector** representation (dimensionality: 70).
   - These vectors are stored in a custom database, consisting of two columns:
     - `ID`: Unique identifier for each image.
     - `embedding`: 70-dimensional vector representing the image.

2. **Indexing System**:

   - Efficient retrieval of the top `k` most similar vectors based on **cosine similarity**.
   - The system is designed to handle large datasets and retrieve results in reasonable timeframes, even with millions of images.

3. **Search Query**:
   - The user uploads an image, which is converted into a vector.
   - The system retrieves the `k` most similar images from the database by comparing the query vector with the stored vectors.

## 📊 Project Features

- **Efficient Vector Storage**: Vectors of image embeddings are stored in a database, optimized for fast retrieval.
- **Image Search**: Users can upload an image and retrieve the top `k` similar images.
- **Scalability**: The system can handle large datasets (up to 20 million image vectors) with fast query response times.

## 📝 Code Structure

- **`vec_db.py`**:

  - Implements the **vectorized database** for storing and querying image vectors.
  - Handles operations such as vector storage, indexing, and retrieval using cosine similarity.

- **`image_search.py`**:

  - Processes the input image, converts it into a vector, and queries the database for similar images.

- **`train_model.py`**:
  - Used to train AI models for generating vector representations of the images.

## 🎯 Deliverables

1. **Design Document**:

   - Detailed explanation of the system architecture, indexing mechanism, and the reasoning behind design decisions.

2. **Code Implementation**:

   - Fully functional image search engine that supports vector-based queries and efficient retrieval of similar images.

3. **Presentation**:
   - Breakdown of both the business and technical aspects of the image search system.

## 🔧 How to Run the Project

1. **Clone the Repository**:

   ```bash
   git clone <repository_url>
   ```

2. **Install Dependencies**:
   Ensure Python 3.x is installed, then install the required libraries:

   ```bash
   pip install -r requirements.txt
   ```

3. **Run the Image Search System**:
   Process the dataset and run the image search system:

   ```bash
   python image_search.py --query <path_to_image> --top_k <number_of_similar_images>
   ```

4. **Train Image Vector Model** (Optional):
   If you want to re-train the image vectorization model:
   ```bash
   python train_model.py
   ```
   **Week 11**: Submit final deliverables (code and design document).

## 👥 Team Members

- **Kareem Ashraf**
- **Mahmoud Seif**
- **Omar Khaled Ali**
